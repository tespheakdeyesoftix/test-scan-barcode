<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barcode Scanner</title>
<style>
    #barcodeResult {
        margin-top: 20px;
    }
</style>
</head>
<body>
<h1>Barcode Scanner</h1>
<div id="barcodeResult"></div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        const video = document.createElement('video');
        const barcodeResult = document.getElementById('barcodeResult');
        const constraints = { video: { facingMode: 'environment' } };

        navigator.mediaDevices.getUserMedia(constraints)
        .then(function(stream) {
            video.srcObject = stream;
            video.setAttribute('playsinline', true);
            video.play();
            scanBarcode();
        })
        .catch(function(err) {
            console.error('Error accessing the camera: ', err);
        });

        function scanBarcode() {
            const barcodeDetector = new BarcodeDetector();

            barcodeDetector.detect(video)
            .then(codes => {
                barcodeResult.innerHTML = '';
                codes.forEach(code => {
                    barcodeResult.innerHTML += `<p>Detected barcode: ${code.rawValue}</p>`;
                });
                setTimeout(scanBarcode, 1000); // Scan again after 1 second
            })
            .catch(error => {
                console.error('Barcode detection error: ', error);
                setTimeout(scanBarcode, 1000); // Try again after 1 second
            });
        }
    } else {
        console.error('Barcode Detection API is not supported.');
    }
});
</script>
</body>
</html>
